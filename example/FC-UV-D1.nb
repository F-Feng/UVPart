(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     70666,       1533]
NotebookOptionsPosition[     68033,       1444]
NotebookOutlinePosition[     68395,       1460]
CellTagsIndexPosition[     68352,       1457]
WindowFrame->Normal
ContainsDynamic->False*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<HighEnergyPhysics`fc`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{"Calc", "[", "1", "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5091653758072996`*^9, 3.509165394198832*^9}, {
  3.509759322184961*^9, 3.5097593275981703`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$HistoryLength", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.517387308912961*^9, 3.5173873205973816`*^9}, {
  3.5174762228558073`*^9, 3.5174762232146077`*^9}, {3.517485539365326*^9, 
  3.517485539474526*^9}, {3.517561026449459*^9, 3.5175610268550596`*^9}}],

Cell[CellGroupData[{

Cell["Init Parameters", "Section",
 CellChangeTimes->{{3.509166503823661*^9, 3.509166508469982*^9}, {
  3.509185193657143*^9, 3.5091852328288116`*^9}, {3.5092401322866535`*^9, 
  3.5092401341274567`*^9}, {3.509241013214588*^9, 3.5092410208586016`*^9}, {
  3.5152369223996916`*^9, 3.5152369362993164`*^9}, {3.515324256482669*^9, 
  3.5153242570910697`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mc", ">", "0"}], ",", 
     RowBox[{"s", ">", "10"}], ",", 
     RowBox[{"\[Zeta]", ">", "0"}], ",", 
     RowBox[{"\[Zeta]", "<", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}], ",", 
     RowBox[{
      SuperscriptBox["\[Zeta]", "2"], "<", 
      RowBox[{
       SuperscriptBox["10", 
        RowBox[{"-", "3"}]], " ", "s", " ", 
       SuperscriptBox["mc", "2"]}]}], ",", 
     RowBox[{"\[Zeta]", "<", 
      RowBox[{
       SuperscriptBox["10", 
        RowBox[{"-", "3"}]], " ", "mc"}]}], ",", 
     RowBox[{"v2", ">", "0"}], ",", 
     RowBox[{"v2", "<", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5091839506826677`*^9, 3.509183961680687*^9}, {
   3.5091842231129723`*^9, 3.509184226092578*^9}, {3.509184294186697*^9, 
   3.5091842944986978`*^9}, {3.5092431588841085`*^9, 3.509243160912112*^9}, {
   3.5093316020792456`*^9, 3.5093316066188536`*^9}, 3.515816490272414*^9, 
   3.515926554482583*^9, {3.5169347951685038`*^9, 3.5169347995989122`*^9}, {
   3.520075848679574*^9, 3.5200758587595882`*^9}, {3.5204737857494955`*^9, 
   3.520473788729101*^9}, {3.5205129790377226`*^9, 3.520512987773738*^9}, {
   3.520513489189819*^9, 3.5205134894238195`*^9}, {3.5208537627405047`*^9, 
   3.5208537682205124`*^9}, {3.5212063468022966`*^9, 
   3.5212063507335033`*^9}, {3.5213670134652433`*^9, 3.521367015914448*^9}, {
   3.5224725863722343`*^9, 3.522472627774707*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$ChangeDimension", "[", "exp_", "]"}], ":=", 
   RowBox[{"ChangeDimension", "[", 
    RowBox[{"exp", ",", "D"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.515324625594917*^9, 3.5153246475753555`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SP", "[", "q1", "]"}], ",", 
       RowBox[{"SP", "[", 
        RowBox[{"q1", ",", "p4"}], "]"}], ",", 
       RowBox[{"SP", "[", 
        RowBox[{"q1", ",", "p3"}], "]"}]}], "}"}], "//", "$ChangeDimension"}],
     "//", "FCI"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.51557464422556*^9, 3.515574657688384*^9}, 
   3.5155748079623013`*^9, {3.515636169328045*^9, 3.5156361883201313`*^9}, {
   3.515639127758388*^9, 3.5156391285695896`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"svars", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"SP", "[", "q1", "]"}], "\[Rule]", 
        SuperscriptBox["q1", "2"]}], ",", 
       RowBox[{
        RowBox[{"SP", "[", 
         RowBox[{"q1", ",", "p4"}], "]"}], "\[Rule]", 
        RowBox[{"q1", " ", "p4"}]}], ",", 
       RowBox[{
        RowBox[{"SP", "[", 
         RowBox[{"q1", ",", "p3"}], "]"}], "\[Rule]", 
        RowBox[{"q1", " ", "p3"}]}]}], "}"}], "//", "$ChangeDimension"}], "//",
     "FCI"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5155635972354903`*^9, 3.5155636500727835`*^9}, {
  3.5155744446388097`*^9, 3.5155744449508104`*^9}, {3.515574817072717*^9, 
  3.515574821362725*^9}, {3.515636204994085*^9, 3.515636220993*^9}, {
  3.515639133514798*^9, 3.5156391339203987`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"$RecursionLimit", "=", "2000"}], ";"}]], "Input",
 CellChangeTimes->{{3.514961394973428*^9, 3.514961400620638*^9}, {
  3.5149684865605464`*^9, 3.5149684963885636`*^9}, {3.5149715933012185`*^9, 
  3.514971593894019*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"q1", "=", "k1"}], ";"}]], "Input",
 CellChangeTimes->{{3.5151190409387984`*^9, 3.515119043868802*^9}, {
  3.5151257237708035`*^9, 3.5151257253776064`*^9}, {3.5153123610422945`*^9, 
  3.515312361245095*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"General", "::", "\"\<spell1\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5158114040870376`*^9, 3.5158114077998443`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SUNSimplify2", "[", "exp_", "]"}], ":=", 
   RowBox[{"SUNSimplify", "[", 
    RowBox[{"exp", ",", 
     RowBox[{"SUNNToCACF", "\[Rule]", "False"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.516968612074625*^9, 3.516968612558226*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Options, Projects & ScalarProducts", "Section",
 CellChangeTimes->{{3.509166503823661*^9, 3.509166508469982*^9}, {
  3.509185193657143*^9, 3.5091852328288116`*^9}, {3.5092401322866535`*^9, 
  3.5092401341274567`*^9}, {3.509241013214588*^9, 3.5092410208586016`*^9}, {
  3.514591223095485*^9, 3.514591225232689*^9}, {3.51460764550064*^9, 
  3.514607647450643*^9}, {3.516786438399437*^9, 3.5167864428922453`*^9}, {
  3.5167864909091296`*^9, 3.516786509285962*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Set Options", "Section"]], "Subsubsection",
 CellChangeTimes->{{3.5091661478806934`*^9, 3.509166150820739*^9}, {
  3.509169283860469*^9, 3.509169286605511*^9}, {3.515325036334346*^9, 
  3.515325039298351*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Eps", ",", 
    RowBox[{"Dimension", "\[Rule]", "D"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"LeviCivita", ",", 
    RowBox[{"Dimension", "\[Rule]", "D"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ScalarProduct", ",", 
    RowBox[{"Dimension", "\[Rule]", "D"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"DiracMatrix", ",", 
    RowBox[{"Dimension", "\[Rule]", "D"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"MetricTensor", ",", 
    RowBox[{"Dimension", "\[Rule]", "D"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"SUNSimplify", ",", 
    RowBox[{"SUNNToCACF", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"SUNSimplify", ",", 
    RowBox[{"Explicit", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"SUNTrace", ",", 
    RowBox[{"Explicit", "\[Rule]", "False"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5111729284937286`*^9, 3.511172959756184*^9}, {
   3.511176805425287*^9, 3.511176805780292*^9}, {3.511236075683121*^9, 
   3.5112360864939404`*^9}, {3.5114302180668907`*^9, 
   3.5114302183393946`*^9}, {3.511432584577886*^9, 3.511432591925499*^9}, {
   3.511432663063462*^9, 3.5114326640774636`*^9}, {3.511481564495466*^9, 
   3.5114815785042915`*^9}, {3.5115843106207027`*^9, 3.51158432608033*^9}, {
   3.5116092466542845`*^9, 3.511609276419136*^9}, {3.511609344731656*^9, 
   3.511609345527258*^9}, 3.5116097967112503`*^9, {3.511609923711073*^9, 
   3.511609930528285*^9}, {3.5116100559745617`*^9, 3.5116100697649856`*^9}, {
   3.511610457534867*^9, 3.5116104586424685`*^9}, {3.511654057941493*^9, 
   3.5116540655075064`*^9}, {3.511654296913127*^9, 3.5116542972407274`*^9}, {
   3.5116549015857887`*^9, 3.51165490224099*^9}, {3.511694436461362*^9, 
   3.5116944432317743`*^9}, {3.511855474200896*^9, 3.5118554825625105`*^9}, {
   3.5118555152289677`*^9, 3.511855517054171*^9}, {3.51185573753283*^9, 
   3.5118557377824306`*^9}, {3.511856510788335*^9, 3.5118565210063534`*^9}, {
   3.5118567043690753`*^9, 3.511856704883876*^9}, {3.5119277799554987`*^9, 
   3.511927791452719*^9}, {3.511928776235649*^9, 3.511928776516449*^9}, {
   3.5119302294917045`*^9, 3.5119302298973055`*^9}, {3.5119325939922686`*^9, 
   3.511932597549075*^9}, {3.5120933005810723`*^9, 3.5120933067898836`*^9}, {
   3.520508866728717*^9, 3.520508882937145*^9}, {3.5205943601796207`*^9, 
   3.520594361942424*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Scalar Product", "Section"]], "Subsubsection",
 CellChangeTimes->{{3.5091661478806934`*^9, 3.509166150820739*^9}, {
  3.509170023838085*^9, 3.509170026681879*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProduct", "[", 
    RowBox[{"p3", ",", "p3"}], "]"}], "=", 
   RowBox[{"4", " ", 
    SuperscriptBox["mc", "2"]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProduct", "[", 
    RowBox[{"p4", ",", "p4"}], "]"}], "=", 
   RowBox[{"4", " ", 
    SuperscriptBox["mc", "2"]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ScalarProduct", "[", 
    RowBox[{"p3", ",", "p4"}], "]"}], "=", 
   RowBox[{
    RowBox[{"2", " ", "s", " ", 
     SuperscriptBox["mc", "2"]}], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["mc", "2"]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.509170031505703*^9, 3.5091700542723026`*^9}, {
   3.5096741728510585`*^9, 3.5096741777962675`*^9}, {3.5096762494686985`*^9, 
   3.509676249765099*^9}, {3.509679351748557*^9, 3.50967936474338*^9}, {
   3.509869136513199*^9, 3.5098691392744036`*^9}, {3.5098692303317633`*^9, 
   3.509869264870224*^9}, {3.5099426187204285`*^9, 3.509942643056472*^9}, 
   3.510032005589161*^9, {3.5145911805386105`*^9, 3.5145911971058397`*^9}, 
   3.51532560025421*^9, {3.5155598626137524`*^9, 3.51555986660736*^9}, {
   3.516769626385085*^9, 3.5167696395651035`*^9}, {3.5167698589297757`*^9, 
   3.5167698740306025`*^9}, {3.5167700014984264`*^9, 
   3.5167700095792403`*^9}, {3.5167711574343634`*^9, 
   3.5167711611783695`*^9}, {3.522466674293009*^9, 3.52246668658583*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Spin & Color Projector ", "Section"]], "Subsubsection",
 CellChangeTimes->{{3.5091661478806934`*^9, 3.509166150820739*^9}, {
  3.509182477317642*^9, 3.5091825357085447`*^9}, {3.5091827024572372`*^9, 
  3.5091827030032387`*^9}, {3.51460737234416*^9, 3.5146073755889654`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Sp\[Psi]", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", 
       SqrtBox["2"], " ", "mc"}]], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"GS", "[", "p3", "]"}], "2"], "-", "mc"}], ")"}], ".", 
      RowBox[{"GA", "[", "\[Psi]", "]"}], ".", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"GS", "[", "p3", "]"}], "2"], "+", "mc"}], ")"}]}], " ", 
     FractionBox["1", 
      SqrtBox["SUNN"]]}], "//", "$ChangeDimension"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sp\[Eta]L", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"GS", "[", "p4", "]"}], "2"], "+", "mc"}], ")"}], "//", 
    "$ChangeDimension"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sp\[Eta]R", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"2", 
       SqrtBox["2"], " ", "mc"}]], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"GS", "[", "p4", "]"}], "2"], "-", "mc"}], ")"}]}], "//", 
    "$ChangeDimension"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.509165414947901*^9, 3.5091655292546563`*^9}, {
   3.5091655606001377`*^9, 3.509165645470191*^9}, {3.509165684328288*^9, 
   3.5091658727239676`*^9}, {3.509165922137226*^9, 3.509166017662443*^9}, {
   3.509166069654492*^9, 3.5091661127276535`*^9}, {3.5091664665868387`*^9, 
   3.5091664791582823`*^9}, {3.509166572667218*^9, 3.5091665778310475`*^9}, {
   3.509166761913875*^9, 3.5091668270861263`*^9}, 3.5091670739502754`*^9, {
   3.509167372176106*^9, 3.5091673969327364`*^9}, {3.509167732660393*^9, 
   3.509167734357919*^9}, {3.509168787410344*^9, 3.5091687916816597`*^9}, {
   3.509169165693654*^9, 3.509169170736232*^9}, {3.5091823374633965`*^9, 
   3.509182345606611*^9}, {3.5091823869622836`*^9, 3.509182391002691*^9}, {
   3.5091824505635953`*^9, 3.5091824614524145`*^9}, {3.5091827071528463`*^9, 
   3.509182757291334*^9}, {3.509883899335286*^9, 3.509883902533292*^9}, {
   3.512378638994759*^9, 3.51237863952516*^9}, {3.514606986378622*^9, 
   3.51460700232185*^9}, {3.514607382967778*^9, 3.514607387210986*^9}, {
   3.5146080797430024`*^9, 3.514608083097008*^9}, {3.5153255823141785`*^9, 
   3.5153255917521954`*^9}, {3.5155552259515877`*^9, 3.5155553006757193`*^9}, 
   3.515559417488567*^9, {3.519882775848355*^9, 3.519882827375245*^9}, {
   3.519951251615971*^9, 3.519951333343296*^9}, {3.5208524726195927`*^9, 
   3.5208525038896365`*^9}, {3.521206399405589*^9, 3.521206403430396*^9}, {
   3.521211839635639*^9, 3.5212118506492586`*^9}, {3.522580817402755*^9, 
   3.522580821146761*^9}, 3.5323403496083922`*^9}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Amptitude for Seleted Diagrams", "Section",
 CellChangeTimes->{{3.509166503823661*^9, 3.509166508469982*^9}, {
  3.509185193657143*^9, 3.5091852328288116`*^9}, {3.5150554952414017`*^9, 
  3.5150555012162123`*^9}}],

Cell[CellGroupData[{

Cell["Load Packages", "Subsubsection",
 CellChangeTimes->{{3.520075263765521*^9, 3.5200752672955265`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "TID`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResetDirectory", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5198841413028297`*^9, 3.5198841509124465`*^9}, {
  3.5206006288849754`*^9, 3.520600635920588*^9}, {3.532343003825488*^9, 
  3.532343004121889*^9}, {3.5324014894363585`*^9, 3.5324015119036436`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load Amptitude & Helper Functions", "Subsubsection",
 CellChangeTimes->{{3.509240264584873*^9, 3.5092402695300817`*^9}, {
  3.509330044981941*^9, 3.5093300471971455`*^9}, {3.5146071004716597`*^9, 
  3.5146071040284653`*^9}, {3.515324617732503*^9, 3.5153246225841117`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"ToFileName", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", "\"\<dmp\>\""}], 
    "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Amp", "=", 
   RowBox[{"<<", "Amp`"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResetDirectory", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5114363403764114`*^9, 3.5114363427164154`*^9}, {
   3.5114759215980244`*^9, 3.5114759383524537`*^9}, {3.511484791475549*^9, 
   3.511484794876355*^9}, {3.5114851939924293`*^9, 3.511485196117462*^9}, {
   3.5114853038716173`*^9, 3.5114853120292425`*^9}, {3.511497904054758*^9, 
   3.5114979077379684`*^9}, {3.5114980100628214`*^9, 3.511498059492648*^9}, {
   3.5114981497768126`*^9, 3.511498153094002*^9}, {3.511498354017494*^9, 
   3.5114984050744143`*^9}, {3.511500381289448*^9, 3.511500384687642*^9}, 
   3.51150086929736*^9, {3.511500901506202*^9, 3.511500916702071*^9}, 
   3.5115016541792526`*^9, {3.511501888887677*^9, 3.51150188997674*^9}, {
   3.5115021379779243`*^9, 3.5115021741779947`*^9}, 3.511515607575919*^9, {
   3.5116923842498255`*^9, 3.5116923902558365`*^9}, {3.5116953978147*^9, 
   3.5116953983451014`*^9}, 3.511695489957271*^9, {3.5118285228275485`*^9, 
   3.511828528318758*^9}, {3.5122051243832116`*^9, 3.512205127300417*^9}, {
   3.5145518487578487`*^9, 3.514551852002654*^9}, 3.51455190056554*^9, {
   3.515412512093251*^9, 3.5154125177716613`*^9}, {3.515487472557562*^9, 
   3.5154874728875628`*^9}, {3.515561790988036*^9, 3.5155617972280474`*^9}, {
   3.515636573790179*^9, 3.5156365740941963`*^9}, {3.516072484001976*^9, 
   3.516072484376377*^9}, {3.51805012319602*^9, 3.5180501236410456`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ShifeMomentum", "[", 
    RowBox[{"exp_", ",", "q_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tmp", "=", "exp"}], ",", "props", ",", "prop", ",", "mom"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"props", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{"tmp", ",", 
         RowBox[{
          RowBox[{"FeynAmpDenominator", "[", "x___", "]"}], "\[RuleDelayed]", 
          "x"}], ",", "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"props", ",", 
          RowBox[{"PropagatorDenominator", "[", 
           RowBox[{"_", ",", "0"}], "]"}]}], "]"}], ",", 
        RowBox[{"Return", "[", "exp", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{"props", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MatchQ", "[", 
             RowBox[{"#", ",", 
              RowBox[{"PropagatorDenominator", "[", 
               RowBox[{"_", ",", "0"}], "]"}]}], "]"}], ")"}], "&"}], ",", 
          "1"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"prop", "=", 
       RowBox[{"tmp", "/.", 
        RowBox[{
         RowBox[{"PropagatorDenominator", "[", 
          RowBox[{"x_", ",", "0"}], "]"}], "\[RuleDelayed]", "x"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mom", "=", 
       RowBox[{"q", "/.", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"prop", "\[Equal]", "0"}], ",", "q"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"exp", "/.", 
        RowBox[{"{", 
         RowBox[{"q", "\[Rule]", 
          RowBox[{"q", "+", 
           RowBox[{"Expand", "[", "mom", "]"}]}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "tmp", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5151469932944055`*^9, 3.5151471209650297`*^9}, {
  3.515147153787487*^9, 3.515147204159976*^9}, {3.515147324217787*^9, 
  3.5151474510772095`*^9}, {3.515147502947301*^9, 3.515147543008171*^9}, {
  3.515147582975441*^9, 3.515147584036243*^9}, {3.5151476302591243`*^9, 
  3.5151476305399246`*^9}, {3.515150095564455*^9, 3.515150148994549*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FactorOut", "[", "1", "]"}], "=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FactorOut", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Longest", "[", "c_", "]"}], " ", "exp_"}], ",", "p_"}], "]"}],
     "/;", 
    RowBox[{"FreeQ", "[", 
     RowBox[{"c", ",", "p"}], "]"}]}], ":=", 
   RowBox[{"c", " ", 
    RowBox[{"FactorOut", "[", "exp", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FactorOut", "[", 
    RowBox[{"exp_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"FactorOut", "[", "exp", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "FactorOut", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5172982647978134`*^9, 3.5172983393659444`*^9}, {
   3.5172988069299655`*^9, 3.517298812857976*^9}, {3.5173120369569407`*^9, 
   3.5173120499049635`*^9}, 3.517358237756935*^9, {3.517368392407118*^9, 
   3.5173684552908287`*^9}, 3.5174556267987323`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DoContract", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmp", ",", "VF"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tmp", "=", 
       RowBox[{"FactorOut", "[", 
        RowBox[{"exp", ",", "_LorentzIndex"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"tmp", "/.", 
        RowBox[{
         RowBox[{"FactorOut", "[", "x_", "]"}], "\[RuleDelayed]", 
         RowBox[{"Distribute", "[", 
          RowBox[{"VF", "[", 
           RowBox[{"ExpandAll", "[", 
            RowBox[{"x", ",", 
             RowBox[{"p_", "/;", 
              RowBox[{"!", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"p", ",", "_LorentzIndex"}], "]"}]}]}]}], "]"}], 
           "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"tmp", "/.", 
        RowBox[{
         RowBox[{"VF", "[", "x_", "]"}], "\[RuleDelayed]", 
         RowBox[{"Contract", "[", "x", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "tmp", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DoContract", "[", 
    RowBox[{"exp_", ",", "pre_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmp", ",", "VF"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tmp", "=", 
       RowBox[{"FactorOut", "[", 
        RowBox[{"exp", ",", "_LorentzIndex"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"tmp", "/.", 
        RowBox[{
         RowBox[{"FactorOut", "[", "x_", "]"}], "\[RuleDelayed]", 
         RowBox[{"Distribute", "[", 
          RowBox[{"VF", "[", 
           RowBox[{"ExpandAll", "[", 
            RowBox[{"x", ",", 
             RowBox[{"p_", "/;", 
              RowBox[{"!", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"p", ",", "_LorentzIndex"}], "]"}]}]}]}], "]"}], 
           "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"tmp", "/.", 
        RowBox[{
         RowBox[{"VF", "[", "x_", "]"}], "\[RuleDelayed]", 
         RowBox[{"Contract", "[", 
          RowBox[{"pre", " ", "x"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Return", "[", "tmp", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5167853105895977`*^9, 3.5167854302574077`*^9}, {
   3.5167854856759667`*^9, 3.5167854860035677`*^9}, {3.5167858537808423`*^9, 
   3.51678585918085*^9}, 3.516790619061596*^9, {3.516963669977955*^9, 
   3.5169636848915815`*^9}, {3.516963818905449*^9, 3.51696382494266*^9}, {
   3.516964016838597*^9, 3.5169640519386587`*^9}, {3.517296560026819*^9, 
   3.51729662323813*^9}, {3.5172984909826107`*^9, 3.5172985755191593`*^9}, {
   3.5172986445804806`*^9, 3.517298680429343*^9}, {3.5172987875391316`*^9, 
   3.517298865055668*^9}, {3.517299108360666*^9, 3.5172991291555023`*^9}, {
   3.517302048624457*^9, 3.517302054224867*^9}, {3.5173022433907986`*^9, 
   3.5173022984120955`*^9}, {3.5173039873207207`*^9, 
   3.5173039988803415`*^9}, {3.5173055383317623`*^9, 
   3.5173056325091276`*^9}, {3.5173057527853394`*^9, 
   3.5173057707565703`*^9}, {3.5173058944023876`*^9, 
   3.5173060576254745`*^9}, {3.517306435178966*^9, 3.5173064422290745`*^9}, {
   3.517306806157164*^9, 3.51730690548619*^9}, {3.517306940349225*^9, 
   3.5173069684821577`*^9}, {3.5173071359872303`*^9, 3.5173072212110395`*^9}, 
   3.5173072729268336`*^9, {3.5173074405119076`*^9, 3.517307444966976*^9}, {
   3.5173112762445407`*^9, 3.517311357146283*^9}, {3.5173114188755913`*^9, 
   3.517311444100836*^9}, {3.517311558480236*^9, 3.5173115681678534`*^9}, {
   3.5173176757830906`*^9, 3.5173176806970997`*^9}, {3.517460002796503*^9, 
   3.5174600732618265`*^9}, {3.5174694399780273`*^9, 
   3.5174695402862034`*^9}, {3.5174752136874866`*^9, 3.517475310641657*^9}, {
   3.51747574519602*^9, 3.517475765023655*^9}, {3.5174758050377254`*^9, 
   3.5174758474386*^9}, {3.517476256941867*^9, 3.517476259843472*^9}, {
   3.517476331572398*^9, 3.517476370291666*^9}, {3.5174764211633554`*^9, 
   3.517476432379775*^9}, {3.5174768630905943`*^9, 3.517476867989003*^9}, {
   3.517476986596011*^9, 3.5174770068916473`*^9}, {3.5174770434269114`*^9, 
   3.517477047295718*^9}, {3.517478349309182*^9, 3.517478383972443*^9}, {
   3.5174805149774227`*^9, 3.5174805234482374`*^9}, {3.517480595527626*^9, 
   3.5174806221412725`*^9}, {3.5174806565549335`*^9, 
   3.5174807256630545`*^9}, {3.517480881105889*^9, 3.517480914677148*^9}, {
   3.5174810516609883`*^9, 3.51748105251899*^9}, {3.517481118631906*^9, 
   3.5174812089560647`*^9}, 3.5174812729161773`*^9, {3.5174816528080444`*^9, 
   3.5174816566768513`*^9}, {3.5174848893673224`*^9, 
   3.5174849807054825`*^9}, {3.5174856335582914`*^9, 
   3.5174856382070994`*^9}, {3.5175512957091403`*^9, 3.5175513274707966`*^9}, 
   3.5175516883514876`*^9, {3.5180528337470546`*^9, 3.51805283646021*^9}, {
   3.5210169061262374`*^9, 3.521016909636244*^9}, {3.5210271177793713`*^9, 
   3.5210271353606024`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ColorSpin", "[", "s___", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{"List", "[", "s", "]"}]}], ",", "n"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Count", "[", 
       RowBox[{"x", ",", "_SUNT"}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"n", "\[Equal]", 
        RowBox[{"Length", "[", "x", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Return", "[", 
         RowBox[{"Dot", "@@", "x"}], "]"}], ";", "Null"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", ">", "0"}], ",", 
        RowBox[{"CDot", "@@", 
         RowBox[{"x", "[", 
          RowBox[{"[", 
           RowBox[{";;", "n"}], "]"}], "]"}]}], ",", "1"}], "]"}], " ", 
      RowBox[{"SDot", "@@", 
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"n", "+", "1"}], ";;"}], "]"}], "]"}]}]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5146079010134883`*^9, 3.514607918220319*^9}, {
   3.5173748656687245`*^9, 3.5173748934991736`*^9}, 3.51737498834734*^9, 
   3.517994004239444*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DoColorSpin", "[", "exp_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{"Trick", "[", "exp", "]"}], "/.", 
        RowBox[{"Dot", "\[Rule]", "ColorSpin"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"tmp", "/.", 
        RowBox[{
         RowBox[{"CDot", "[", "t___", "]"}], "\[RuleDelayed]", 
         RowBox[{"SUNTrace", "[", 
          RowBox[{"Dot", "[", "t", "]"}], "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{"tmp", "//", "SUNSimplify"}], "//", "Simplify"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "tmp", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5173750992011347`*^9, 3.517375159542041*^9}, {
   3.517375269584634*^9, 3.517375271051037*^9}, {3.518047007530814*^9, 
   3.5180470170853605`*^9}, {3.518047088177427*^9, 3.5180470910945935`*^9}, 
   3.518047125686572*^9, {3.5180472656795793`*^9, 3.5180473042097836`*^9}, {
   3.518047400771306*^9, 3.518047401279335*^9}, 3.5198845435963364`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$NRL", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ReplaceLines", "[", "exp_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tmp", ",", "VF", ",", 
      RowBox[{"$i", "=", "0"}], ",", "$tot", ",", "$contract", ",", "den"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"$NRL", ",", "Blue", ",", "Bold"}], "]"}], ",", 
         "\"\<\\t\>\"", ",", "\"\<Do ReplaceLines ...\>\"", ",", 
         "\"\<\\t\>\"", ",", 
         RowBox[{"DateString", "[", "]"}]}], "}"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"exp", "//", "$ChangeDimension"}]}], ";", "\[IndentingNewLine]",
      
     RowBox[{"$contract", "=", 
      RowBox[{"!", 
       RowBox[{"FreeQ", "[", 
        RowBox[{"tmp", ",", "_DiracTrace"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "/.", 
       RowBox[{"DiracTrace", "\[Rule]", "DoColorSpin"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"$LineA1", "[", "l1_", "]"}], " ", 
          RowBox[{"$LineA2", "[", "l2_", "]"}]}], "\[RuleDelayed]", 
         RowBox[{"DoColorSpin", "[", 
          RowBox[{
          "Sp\[Eta]L", ".", "l1", ".", "Sp\[Psi]", ".", "l2", ".", 
           "Sp\[Eta]R", ".", 
           RowBox[{"GAD", "[", "5", "]"}]}], "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"$LineB1", "[", "l1_", "]"}], " ", 
          RowBox[{"$LineB2", "[", "l2_", "]"}]}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"DoColorSpin", "[", 
            RowBox[{"l2", ".", "Sp\[Psi]"}], "]"}], " ", 
           RowBox[{"DoColorSpin", "[", 
            RowBox[{"Sp\[Eta]L", ".", "l1", ".", "Sp\[Eta]R", ".", 
             RowBox[{"GAD", "[", "5", "]"}]}], "]"}]}], ")"}]}], "}"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{"tmp", "//", "SUNSimplify"}], "//", "Factor"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "/.", 
       RowBox[{
        RowBox[{"SDot", "[", "g___", "]"}], "\[RuleDelayed]", 
        RowBox[{"Tr", "[", 
         RowBox[{"Dot", "[", "g", "]"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "//", "Contract"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"$NRL", ",", 
           RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", "\"\<\\t\>\"", 
         ",", "\"\<TID Expanding...\>\"", ",", "\"\<\\t\>\"", ",", 
         RowBox[{"DateString", "[", "]"}]}], "}"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"tmp", "//", "MomentumExpand"}], "//", 
        "ScalarProductExpand"}], "//", "EpsEvaluate"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"tmp", "//", "MomentumExpand"}], "//", 
        "ScalarProductExpand"}], "//", "EpsEvaluate"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"FactorOut", "[", 
       RowBox[{"tmp", ",", 
        RowBox[{
         RowBox[{"FCI", "[", 
          RowBox[{"FVD", "[", 
           RowBox[{"q1", ",", "_"}], "]"}], "]"}], " ", "|", " ", "_Eps"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "/.", 
       RowBox[{
        RowBox[{"FactorOut", "[", "x_", "]"}], "\[RuleDelayed]", 
        RowBox[{"Distribute", "[", 
         RowBox[{"VF", "[", 
          RowBox[{"Expand2", "[", 
           RowBox[{"x", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"FCI", "[", 
               RowBox[{"FVD", "[", 
                RowBox[{"q1", ",", "_"}], "]"}], "]"}], ",", "_Eps"}], 
             "}"}]}], "]"}], "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"Collect2", "[", 
       RowBox[{
        RowBox[{"tmp", "/.", 
         RowBox[{
          RowBox[{"VF", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Longest", "[", "c_", "]"}], " ", "ex_"}], "/;", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"c", ",", 
              RowBox[{
               RowBox[{"FCI", "[", 
                RowBox[{"FVD", "[", 
                 RowBox[{"q1", ",", "_"}], "]"}], "]"}], " ", "|", " ", 
               "_Eps"}]}], "]"}]}], "]"}], "\[RuleDelayed]", 
          RowBox[{"c", " ", 
           RowBox[{"VF", "[", "ex", "]"}]}]}]}], ",", "_VF"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"$tot", "=", 
      RowBox[{"Count", "[", 
       RowBox[{"tmp", ",", "_VF", ",", "Infinity"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"$NRL", ",", 
           RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", "\"\<\\t\>\"", 
         ",", "\"\<TIDing ... \>\"", ",", "\"\<\\t\>\"", ",", "$tot", ",", 
         "\"\<\\t\>\"", ",", 
         RowBox[{"DateString", "[", "]"}]}], "}"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{"tmp", "/.", 
       RowBox[{
        RowBox[{"VF", "[", "x_", "]"}], "\[RuleDelayed]", 
        RowBox[{"Contract", "[", 
         RowBox[{"$TID", "[", 
          RowBox[{
           RowBox[{"Uncontract", "[", 
            RowBox[{"x", ",", "q1", ",", 
             RowBox[{"Pair", "\[Rule]", 
              RowBox[{"{", "}"}]}]}], "]"}], ",", "q1", ",", 
           RowBox[{"{", 
            RowBox[{"p3", ",", "p4"}], "}"}]}], "]"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"PrintTemporary", "[", 
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"$NRL", ",", 
           RowBox[{"Opacity", "[", "0", "]"}]}], "]"}], ",", "\"\<\\t\>\"", 
         ",", "\"\<Final Collecting...\>\"", ",", "\"\<\\t\>\"", ",", 
         RowBox[{"DateString", "[", "]"}]}], "}"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      RowBox[{
       RowBox[{"tmp", "//", "Together"}], "//", "Factor2"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp", "=", 
      FractionBox[
       RowBox[{"Collect2", "[", 
        RowBox[{
         RowBox[{"Numerator", "[", "tmp", "]"}], ",", "vars", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#", "//", "Together"}], "//", "Factor2"}], ")"}], 
          "&"}]}], "]"}], 
       RowBox[{
        RowBox[{"Denominator", "[", "tmp", "]"}], "//", "Factor"}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ClearSystemCache", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"$NRL", "++"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "tmp", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.51460765715386*^9, 3.514607692519122*^9}, {
   3.5146085983035135`*^9, 3.514608601470319*^9}, {3.514608633419175*^9, 
   3.5146086383331833`*^9}, {3.51460875581699*^9, 3.514608762790202*^9}, 
   3.514608939538512*^9, 3.5149610291085267`*^9, 3.5149612389002275`*^9, {
   3.514961771731472*^9, 3.514961783665493*^9}, {3.514967969448881*^9, 
   3.5149679725376863`*^9}, {3.514968140517662*^9, 3.5149681411572633`*^9}, {
   3.51503697982609*^9, 3.5150369935541143`*^9}, {3.5150370675294437`*^9, 
   3.5150370939558907`*^9}, {3.5150371908196645`*^9, 
   3.5150371945792713`*^9}, {3.5150372699586034`*^9, 3.515037324012698*^9}, {
   3.5152370507255173`*^9, 3.515237059211932*^9}, {3.515324174629325*^9, 
   3.5153241794497333`*^9}, {3.5153249051544533`*^9, 
   3.5153249105208626`*^9}, {3.5153264186085167`*^9, 3.515326428311734*^9}, {
   3.5153755943720894`*^9, 3.5153756003936996`*^9}, {3.5153758343297763`*^9, 
   3.515375852815809*^9}, {3.5155563041103773`*^9, 3.5155563159663982`*^9}, {
   3.5168554125187416`*^9, 3.5168554145623455`*^9}, {3.517309166685053*^9, 
   3.5173091843910837`*^9}, {3.51735834294792*^9, 3.5173583957228127`*^9}, {
   3.5173606751988163`*^9, 3.51736067721122*^9}, {3.517361845161333*^9, 
   3.5173618703085775`*^9}, {3.517368599606682*^9, 3.5173686010730844`*^9}, {
   3.517368648746768*^9, 3.5173686538947773`*^9}, {3.517368691912044*^9, 
   3.517368692458045*^9}, {3.5173687661681747`*^9, 3.5173688125002556`*^9}, {
   3.517368885383584*^9, 3.5173689570345097`*^9}, {3.5173689889209657`*^9, 
   3.5173690082805996`*^9}, {3.517371355886588*^9, 3.517371356126589*^9}, {
   3.517371636178625*^9, 3.517371654758651*^9}, {3.517372970226961*^9, 
   3.517373025941441*^9}, {3.5173730993110456`*^9, 3.51737310911226*^9}, {
   3.517375033181819*^9, 3.5173750455214405`*^9}, {3.5173750835075073`*^9, 
   3.5173750894979177`*^9}, {3.5173751695728583`*^9, 3.517375208026926*^9}, {
   3.5173752492421985`*^9, 3.517375313451911*^9}, {3.5173753477719717`*^9, 
   3.51737538126523*^9}, {3.517375622146132*^9, 3.517375626912196*^9}, {
   3.5173766504829903`*^9, 3.5173766613562093`*^9}, {3.517377354865563*^9, 
   3.517377364131979*^9}, {3.5174686834299364`*^9, 3.517468684802739*^9}, {
   3.5174687797913055`*^9, 3.5174687865305176`*^9}, {3.5174689443045235`*^9, 
   3.5174689606689525`*^9}, {3.517469378048911*^9, 3.5174693817305174`*^9}, {
   3.517472363173561*^9, 3.517472365279565*^9}, {3.5174725053834114`*^9, 
   3.51747251064062*^9}, {3.517472575645934*^9, 3.5174725808407435`*^9}, {
   3.5174727583534555`*^9, 3.517472766059869*^9}, {3.517472848552814*^9, 
   3.517472874339659*^9}, {3.517473244037771*^9, 3.5174732491857805`*^9}, {
   3.517473362176779*^9, 3.5174733870120225`*^9}, {3.5174734906308966`*^9, 
   3.5174735211445503`*^9}, {3.517474499132256*^9, 3.5174745096622744`*^9}, {
   3.517474624297269*^9, 3.517474646496108*^9}, {3.517474713545026*^9, 
   3.5174747771463375`*^9}, {3.517474905851484*^9, 3.5174749084098883`*^9}, {
   3.517475089822607*^9, 3.517475090368608*^9}, {3.5174771796307507`*^9, 
   3.517477189536768*^9}, {3.517477405415209*^9, 3.517477418020031*^9}, {
   3.51747833115075*^9, 3.517478331665551*^9}, {3.5174817035081334`*^9, 
   3.517481709482944*^9}, {3.517483792679403*^9, 3.5174839285712414`*^9}, {
   3.5174843096703043`*^9, 3.5174844347201233`*^9}, {3.517484471816989*^9, 
   3.5174844720665894`*^9}, {3.5174845394275074`*^9, 3.517484541861112*^9}, {
   3.517485308196858*^9, 3.5174853352473054`*^9}, {3.517485623059473*^9, 
   3.517485623324673*^9}, {3.5174856719343586`*^9, 3.517485675038764*^9}, {
   3.5174857878269625`*^9, 3.517485788294963*^9}, {3.517562495158517*^9, 
   3.517562506062936*^9}, {3.5175625803502665`*^9, 3.517562586995878*^9}, {
   3.517562645417981*^9, 3.517562646697183*^9}, {3.5198835542300243`*^9, 
   3.5198835694088507`*^9}, {3.519884254761829*^9, 3.519884265120247*^9}, {
   3.5198843273487563`*^9, 3.5198843587204113`*^9}, {3.5198844044128914`*^9, 
   3.519884441057356*^9}, 3.519884613609259*^9, {3.5198851176305447`*^9, 
   3.519885129938966*^9}, {3.5199488227783885`*^9, 3.519948845336028*^9}, {
   3.5200803245128818`*^9, 3.520080327976088*^9}, {3.520080533022848*^9, 
   3.520080533381649*^9}, {3.520118425134408*^9, 3.520118448643649*^9}, {
   3.5201185136645637`*^9, 3.5201185717434654`*^9}, {3.520118610291133*^9, 
   3.520118660804022*^9}, {3.520118716451878*^9, 3.5201187534863434`*^9}, {
   3.5201187854819994`*^9, 3.520118795481617*^9}, {3.5201188568365245`*^9, 
   3.5201188578505263`*^9}, {3.520119056828876*^9, 3.5201190635680876`*^9}, 
   3.520119166887069*^9, {3.5201192673200455`*^9, 3.520119273950057*^9}, {
   3.5201196422627087`*^9, 3.5201196441551113`*^9}, {3.5201198971743093`*^9, 
   3.52011991140473*^9}, {3.520120246434284*^9, 3.520120290334958*^9}, {
   3.520125195365607*^9, 3.5201251971256094`*^9}, {3.520125228325653*^9, 
   3.5201252475556793`*^9}, {3.5204103235743313`*^9, 3.5204103280469*^9}, {
   3.5204106054011602`*^9, 3.5204106058986673`*^9}, {3.520410741660753*^9, 
   3.5204107955615807`*^9}, {3.5204124785062046`*^9, 3.520412566583959*^9}, {
   3.520412597331613*^9, 3.5204125976592135`*^9}, {3.520413505792688*^9, 
   3.520413521361515*^9}, {3.520413640732925*^9, 3.5204136523393455`*^9}, {
   3.520414026913968*^9, 3.520414027865569*^9}, {3.520414061171628*^9, 
   3.5204140617176285`*^9}, {3.5204141106237144`*^9, 
   3.5204141151009226`*^9}, {3.5204141814799023`*^9, 
   3.5204142088891497`*^9}, {3.520414515086488*^9, 3.520414540676196*^9}, {
   3.520414945893764*^9, 3.520414947547367*^9}, {3.5204149884038386`*^9, 
   3.520414991477044*^9}, {3.520416223971012*^9, 3.520416224407037*^9}, {
   3.5204162660064163`*^9, 3.520416332754234*^9}, {3.520416370434389*^9, 
   3.5204163746946325`*^9}, {3.5204164301028023`*^9, 
   3.5204164329829664`*^9}, {3.5204222079698963`*^9, 
   3.5204222185779147`*^9}, {3.5204222548479786`*^9, 3.520422266095598*^9}, {
   3.520422337957385*^9, 3.520422349142605*^9}, {3.5204223869726715`*^9, 
   3.5204224039767013`*^9}, {3.5204225993909907`*^9, 3.520422605896202*^9}, {
   3.520422646971074*^9, 3.520422647376675*^9}, {3.520424253612277*^9, 
   3.520424256747883*^9}, {3.5204736902617283`*^9, 3.520473699777745*^9}, {
   3.520473731835801*^9, 3.5204737588706484`*^9}, {3.5204759798097053`*^9, 
   3.5204759846145134`*^9}, {3.5204760170157704`*^9, 
   3.5204760344878016`*^9}, {3.5204761758552494`*^9, 
   3.5204762545573874`*^9}, {3.5204763506379566`*^9, 
   3.5204764002616434`*^9}, {3.520476493206607*^9, 3.5204764975746145`*^9}, {
   3.52047652908667*^9, 3.5204766552752914`*^9}, {3.520476696662164*^9, 
   3.5204767210138073`*^9}, {3.5204769302725744`*^9, 
   3.5204769335641804`*^9}, {3.5204770255701427`*^9, 3.520477034789759*^9}, {
   3.5204781724581375`*^9, 3.520478180164551*^9}, {3.520478390733721*^9, 
   3.5204783950549283`*^9}, {3.520478752583387*^9, 3.52047877710663*^9}, {
   3.520479149302395*^9, 3.5204791788020463`*^9}, {3.520479606666614*^9, 
   3.5204796097398195`*^9}, 3.520479657541544*^9, {3.520481819459079*^9, 
   3.520481827383892*^9}, {3.520482115358118*^9, 3.5204821158201213`*^9}, {
   3.5204830233212748`*^9, 3.5204830239452753`*^9}, {3.5204835670410357`*^9, 
   3.5204835694590397`*^9}, {3.520483606134704*^9, 3.5204836202527285`*^9}, {
   3.520483754007364*^9, 3.520483758437772*^9}, 3.520483913171789*^9, {
   3.520486369282763*^9, 3.520486546280674*^9}, {3.520497704533494*^9, 
   3.5204978193496957`*^9}, {3.5204978627801723`*^9, 3.520497875774995*^9}, {
   3.520497953603532*^9, 3.5204979540871325`*^9}, {3.520497994818804*^9, 
   3.520498006799625*^9}, {3.520498179315792*^9, 3.5204981940422173`*^9}, {
   3.5204985893563433`*^9, 3.520498595502754*^9}, {3.5204992399409227`*^9, 
   3.5204992493810678`*^9}, {3.520499377376438*^9, 3.520499391822064*^9}, {
   3.520500303323295*^9, 3.520500332989209*^9}, {3.520501312129949*^9, 
   3.520501365669243*^9}, {3.520501563805191*^9, 3.5205015663479958`*^9}, {
   3.52050270122787*^9, 3.5205028282432933`*^9}, {3.5205032125181103`*^9, 
   3.520503216667717*^9}, {3.5205033824486084`*^9, 3.5205033863486156`*^9}, {
   3.5205045491811256`*^9, 3.5205045942496047`*^9}, {3.5205047455230703`*^9, 
   3.5205047563806896`*^9}, 3.5205064805153418`*^9, {3.520506540918648*^9, 
   3.520506569607098*^9}, 3.5205066131623745`*^9, {3.520506793592292*^9, 
   3.520506900436879*^9}, {3.520506934632139*^9, 3.520506995675047*^9}, {
   3.5205090409034615`*^9, 3.5205090425726643`*^9}, {3.5205090744435205`*^9, 
   3.5205091098399825`*^9}, {3.5205092561328897`*^9, 3.520509293276555*^9}, {
   3.5205093308726206`*^9, 3.5205093766275015`*^9}, {3.5205094144887676`*^9, 
   3.5205094737064714`*^9}, {3.5205106018850446`*^9, 
   3.5205106452687206`*^9}, {3.5205135121062593`*^9, 
   3.5205135448351164`*^9}, {3.5205135934760017`*^9, 
   3.5205136387004814`*^9}, {3.520513670181337*^9, 3.5205137750135207`*^9}, {
   3.520513808241579*^9, 3.5205138125003867`*^9}, {3.52051390552335*^9, 
   3.5205139227145805`*^9}, {3.520514017547147*^9, 3.5205140184831486`*^9}, {
   3.520514063910428*^9, 3.520514086296468*^9}, {3.520514231860323*^9, 
   3.520514260486374*^9}, {3.5205143108900623`*^9, 3.5205143736801724`*^9}, {
   3.5205160550099545`*^9, 3.5205160846656065`*^9}, {3.52051613196489*^9, 
   3.5205162147698355`*^9}, {3.52051656567343*^9, 3.520516586374666*^9}, {
   3.520516644843569*^9, 3.520516655326787*^9}, {3.520519454628594*^9, 
   3.520519481335841*^9}, {3.5205206301842585`*^9, 3.5205206317754617`*^9}, {
   3.5205207371692467`*^9, 3.520520739602851*^9}, {3.5205550665628347`*^9, 
   3.5205550803844585`*^9}, {3.520556182865447*^9, 3.520556217341508*^9}, {
   3.5205575648690295`*^9, 3.5205575693150377`*^9}, {3.520593935156492*^9, 
   3.520593938510498*^9}, {3.520594091375549*^9, 3.52059409185915*^9}, {
   3.520594135710827*^9, 3.5205941469584465`*^9}, {3.5205943748124466`*^9, 
   3.5205944529841843`*^9}, {3.52059461594207*^9, 3.520594720025453*^9}, {
   3.520594848023678*^9, 3.5205948497708807`*^9}, {3.520594994944736*^9, 
   3.5205949990475435`*^9}, 3.5205952763224297`*^9, {3.520595330345325*^9, 
   3.52059533890974*^9}, {3.520595420341883*^9, 3.5205954267534943`*^9}, {
   3.5205957183336067`*^9, 3.520595768440894*^9}, {3.520595887625104*^9, 
   3.520595892757513*^9}, {3.5205962523291597`*^9, 3.5205962721099944`*^9}, {
   3.5205963195808773`*^9, 3.5205963313432984`*^9}, {3.520596397986615*^9, 
   3.5205964036338253`*^9}, {3.5205964805640125`*^9, 
   3.5205965091900625`*^9}, {3.520596704674006*^9, 3.5205967130980206`*^9}, {
   3.5205967767149324`*^9, 3.52059679789977*^9}, {3.520596903355955*^9, 
   3.5205970478122087`*^9}, {3.5205970998227*^9, 3.5205971043467083`*^9}, {
   3.520597690314937*^9, 3.5205977065701656`*^9}, {3.520599942256892*^9, 
   3.5205999684805384`*^9}, {3.5206002091662383`*^9, 3.520600209681039*^9}, {
   3.5206006486658106`*^9, 3.5206006649678392`*^9}, {3.5206013021422443`*^9, 
   3.520601303577447*^9}, {3.520608466697508*^9, 3.520608481439533*^9}, {
   3.5206533820981736`*^9, 3.5206533845473776`*^9}, {3.5206800569645853`*^9, 
   3.5206800594761896`*^9}, {3.5206801695811825`*^9, 3.520680217629267*^9}, {
   3.520680252120928*^9, 3.520680278188574*^9}, {3.520680313787836*^9, 
   3.5206803433342876`*^9}, {3.5206822583248653`*^9, 3.520682292813717*^9}, {
   3.520682383475857*^9, 3.520682390735868*^9}, {3.5206826341554313`*^9, 
   3.5206827048647375`*^9}, {3.52068291619495*^9, 3.5206829471121955`*^9}, {
   3.5206841214672756`*^9, 3.5206841272236857`*^9}, {3.520687434354436*^9, 
   3.520687434962837*^9}, {3.520713674877845*^9, 3.5207136803378544`*^9}, {
   3.5207193543557606`*^9, 3.5207194117326612`*^9}, {3.5207262690509634`*^9, 
   3.5207262788633804`*^9}, {3.520733804857044*^9, 3.5207338104574537`*^9}, {
   3.5207352093910446`*^9, 3.5207352138058524`*^9}, {3.5207364919113345`*^9, 
   3.5207364950595145`*^9}, {3.520740272151431*^9, 3.5207402870338573`*^9}, {
   3.5207417902603297`*^9, 3.5207418269671946`*^9}, {3.520743098049732*^9, 
   3.520743117774964*^9}, 3.5207451234962983`*^9, {3.520745691806294*^9, 
   3.5207457122241077`*^9}, {3.5207458263747625`*^9, 3.520745855177705*^9}, {
   3.5207491789375134`*^9, 3.5207492033203564`*^9}, {3.5207494391449738`*^9, 
   3.52074946224123*^9}, {3.520749730871063*^9, 3.520749739295078*^9}, {
   3.5207500022061663`*^9, 3.52075001416885*^9}, {3.5208252731207438`*^9, 
   3.520825294227581*^9}, {3.520825888440648*^9, 3.5208259137906923`*^9}, {
   3.5208259469563503`*^9, 3.5208259689211893`*^9}, {3.5208260212748814`*^9, 
   3.5208260479509277`*^9}, {3.520827809849059*^9, 3.5208278119238625`*^9}, {
   3.520832831456552*^9, 3.5208328567909966`*^9}, {3.520852265619296*^9, 
   3.520852316919368*^9}, {3.520852371189444*^9, 3.520852387759467*^9}, {
   3.5208529360902414`*^9, 3.520852936340242*^9}, {3.520853803680562*^9, 
   3.5208538140705767`*^9}, {3.5208539415007553`*^9, 3.52085395911078*^9}, {
   3.5208539940208282`*^9, 3.520854012830855*^9}, {3.52085428797124*^9, 
   3.520854288351241*^9}, {3.520854470956751*^9, 3.520854473406754*^9}, {
   3.52085465826303*^9, 3.520854737683141*^9}, {3.5208547772231965`*^9, 
   3.5208547793531995`*^9}, {3.520854893513359*^9, 3.520854898393366*^9}, {
   3.520855017523533*^9, 3.5208550653035994`*^9}, {3.5208551945937805`*^9, 
   3.520855200163789*^9}, {3.5208553538240037`*^9, 3.5208553594740114`*^9}, {
   3.520855626284385*^9, 3.520855671754449*^9}, {3.52085728239552*^9, 
   3.5208573355136137`*^9}, {3.520861403205158*^9, 3.5208614066839647`*^9}, {
   3.5208614369636173`*^9, 3.5208614395532217`*^9}, {3.5208632155383415`*^9, 
   3.520863217535145*^9}, {3.520913988776746*^9, 3.520914010164383*^9}, {
   3.5209142502757244`*^9, 3.5209142543329563`*^9}, {3.520914414459115*^9, 
   3.520914457449574*^9}, {3.5209145976426888`*^9, 3.5209145979347053`*^9}, {
   3.5209194052165527`*^9, 3.520919443670621*^9}, {3.5209194971163144`*^9, 
   3.5209195080363336`*^9}, {3.520919588137561*^9, 3.520919599821982*^9}, {
   3.5209202483852615`*^9, 3.520920355151849*^9}, {3.5209225578640594`*^9, 
   3.520922581544901*^9}, {3.52092267745387*^9, 3.520922680261874*^9}, {
   3.5209230986546097`*^9, 3.52092309893541*^9}, {3.5209315399871116`*^9, 
   3.5209315693620634`*^9}, {3.520931655907894*^9, 3.5209317106687355`*^9}, 
   3.520933968091213*^9, {3.5209364616930895`*^9, 3.520936472845262*^9}, {
   3.520936620518955*^9, 3.5209366263265715`*^9}, {3.520938284499417*^9, 
   3.5209382930688133`*^9}, {3.520942028052032*^9, 3.5209422220747566`*^9}, {
   3.521002303338076*^9, 3.5210023667365875`*^9}, {3.5210064831568637`*^9, 
   3.521006490036476*^9}, {3.521013440840952*^9, 3.521013479201419*^9}, {
   3.5210136315357656`*^9, 3.521013637943364*^9}, {3.521013747158269*^9, 
   3.5210137502158747`*^9}, {3.5210165708036485`*^9, 3.52101657164605*^9}, {
   3.5210166801910405`*^9, 3.5210166869770527`*^9}, {3.52101671976831*^9, 
   3.5210167209539123`*^9}, {3.5210167877844296`*^9, 3.521016795943244*^9}, 
   3.5210168425093255`*^9, {3.5210168856122017`*^9, 3.521016886719803*^9}, {
   3.5210169692751484`*^9, 3.5210169913803873`*^9}, {3.5210211044475574`*^9, 
   3.521021136146813*^9}, 3.5210215423091264`*^9, {3.5210259818349047`*^9, 
   3.5210259948765273`*^9}, {3.5210260603654423`*^9, 
   3.5210260691794577`*^9}, {3.5210261336075706`*^9, 
   3.5210261339819717`*^9}, {3.521026197614484*^9, 3.5210262551317844`*^9}, {
   3.5210262876422415`*^9, 3.521026288250643*^9}, {3.521026393894028*^9, 
   3.521026394284029*^9}, {3.5210264806769805`*^9, 3.5210264918778005`*^9}, {
   3.5210265260574603`*^9, 3.521026580907157*^9}, {3.521026705239375*^9, 
   3.521026721588204*^9}, {3.521026875810075*^9, 3.5210269006765184`*^9}, {
   3.5210269455109973`*^9, 3.521026949255004*^9}, {3.5210272730776443`*^9, 
   3.5210273120621123`*^9}, {3.52102754591358*^9, 3.521027566848817*^9}, {
   3.521027913029025*^9, 3.5210279224514413`*^9}, {3.521028219507163*^9, 
   3.521028220536765*^9}, 3.5210303580719357`*^9, {3.521031853076623*^9, 
   3.5210318578502316`*^9}, {3.5210729727037115`*^9, 3.52107304032983*^9}, {
   3.52107341577569*^9, 3.521073543399514*^9}, {3.521076548246973*^9, 
   3.5210765631449995`*^9}, {3.5210776957962437`*^9, 3.521077729117902*^9}, {
   3.5210780134459333`*^9, 3.521078052414802*^9}, {3.5210789666544075`*^9, 
   3.5210789778552275`*^9}, {3.521082594231897*^9, 3.521082708346097*^9}, {
   3.5210827478297663`*^9, 3.5210827501541705`*^9}, {3.521083816182043*^9, 
   3.5210838366492786`*^9}, {3.521084327743894*^9, 3.5210843518459363`*^9}, {
   3.5210845432705603`*^9, 3.521084546446164*^9}, {3.521089004935892*^9, 
   3.521089062063193*^9}, {3.5210891808438344`*^9, 3.521089217098298*^9}, {
   3.5211048776208935`*^9, 3.521104905649338*^9}, {3.5211050591994476`*^9, 
   3.521105062662654*^9}, {3.5211054269232936`*^9, 3.52110545910615*^9}, {
   3.521106055992137*^9, 3.5211061131144037`*^9}, 3.5211061601080914`*^9, {
   3.5211063218113403`*^9, 3.5211063224413767`*^9}, {3.521106486967787*^9, 
   3.5211064921670847`*^9}, {3.521107733294073*^9, 3.521107753367221*^9}, {
   3.5211080958238087`*^9, 3.5211081254195013`*^9}, {3.5211082088962755`*^9, 
   3.521108236321844*^9}, {3.5211085099124928`*^9, 3.521108515546815*^9}, {
   3.521108681175288*^9, 3.521108684657488*^9}, {3.5211092917422113`*^9, 
   3.521109294269356*^9}, {3.5211096370679626`*^9, 3.521109638856065*^9}, {
   3.5211096728390083`*^9, 3.5211096785193334`*^9}, {3.521109742298981*^9, 
   3.521109808467766*^9}, {3.5211101272009964`*^9, 3.521110137420581*^9}, {
   3.5211102161280828`*^9, 3.521110226490676*^9}, {3.521202726360623*^9, 
   3.5212027266206236`*^9}, {3.521202959895811*^9, 3.5212029951554685`*^9}, 
   3.5212030256187196`*^9, {3.5212030631491823`*^9, 3.521203086959617*^9}, 
   3.521203158856936*^9, 3.5212032005938063`*^9, {3.5212051338057117`*^9, 
   3.521205138126919*^9}, {3.521205741301978*^9, 3.521205779210045*^9}, {
   3.5212062407221107`*^9, 3.5212063060706253`*^9}, {3.52120645154088*^9, 
   3.5212064520244813`*^9}, {3.5212065765137663`*^9, 3.521206618025439*^9}, {
   3.521206696181576*^9, 3.521206719285217*^9}, {3.5212068960647273`*^9, 
   3.521206897265929*^9}, {3.5212069328027916`*^9, 3.5212069357355967`*^9}, {
   3.5212069742364645`*^9, 3.5212069743612647`*^9}, {3.5212099511988335`*^9, 
   3.521209975706476*^9}, {3.5212106543544683`*^9, 3.5212106663508897`*^9}, {
   3.5212114250164332`*^9, 3.521211453985684*^9}, {3.5212535792483864`*^9, 
   3.5212536046140313`*^9}, 3.521254447415766*^9, {3.5212544820790267`*^9, 
   3.5212544864314346`*^9}, {3.5212557258627477`*^9, 3.521255726720749*^9}, {
   3.5212570219741325`*^9, 3.521257050724983*^9}, {3.5212570922678556`*^9, 
   3.521257101877473*^9}, {3.5212571482563543`*^9, 3.5212572299068975`*^9}, {
   3.521342531753134*^9, 3.5213425332819366`*^9}, {3.5213437490084763`*^9, 
   3.5213437606772966`*^9}, {3.5213738550747643`*^9, 3.521373866291184*^9}, {
   3.5214536900585065`*^9, 3.521453696048917*^9}, {3.5323405882810435`*^9, 
   3.5323406597331305`*^9}, {3.5323429362473392`*^9, 
   3.5323429642419405`*^9}, {3.532343458721967*^9, 3.5323434683815193`*^9}, {
   3.53234410952633*^9, 3.532344117466744*^9}, 3.5323441542984085`*^9, {
   3.5324154114098167`*^9, 3.532415419584231*^9}, 3.5324154682407165`*^9, {
   3.5324157736424527`*^9, 3.532415777105659*^9}, {3.5324158625314093`*^9, 
   3.532415865791815*^9}, {3.532415989453232*^9, 3.532415997487246*^9}, {
   3.5324160311521053`*^9, 3.532416031635706*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Select Diagrams", "Subsubsection",
 CellChangeTimes->{{3.509240264584873*^9, 3.5092402695300817`*^9}, {
  3.509330044981941*^9, 3.5093300471971455`*^9}, {3.515037013506549*^9, 
  3.5150370148793516`*^9}, {3.515052825120103*^9, 3.5150528283649087`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SelectedAmp", "=", 
   RowBox[{"Amp", "[", 
    RowBox[{"[", 
     RowBox[{"{", "1", "}"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.514628176232261*^9, 3.514628177854664*^9}, {
   3.5148596326298094`*^9, 3.51485963281701*^9}, {3.5148598246341968`*^9, 
   3.5148598272862015`*^9}, {3.514861312765939*^9, 3.5148613131091394`*^9}, 
   3.5148694108346505`*^9, 3.5149590987220984`*^9, {3.515036647966707*^9, 
   3.5150366482475076`*^9}, {3.5150528355097213`*^9, 
   3.5150528452285385`*^9}, {3.5150577612833047`*^9, 3.5150577616733055`*^9}, 
   3.5151500246779304`*^9, 3.5151507834476633`*^9, 3.5152147513761654`*^9, {
   3.515235724440568*^9, 3.515235724892969*^9}, {3.51523668504354*^9, 
   3.5152366853711405`*^9}, {3.51531572303968*^9, 3.5153157238771925`*^9}, {
   3.515324084960367*^9, 3.515324102135998*^9}, {3.5153244232781615`*^9, 
   3.515324425165765*^9}, 3.5154871230911827`*^9, {3.515487277539277*^9, 
   3.5154872910480967`*^9}, {3.515487339441768*^9, 3.5154873464661784`*^9}, 
   3.5154878000151815`*^9, {3.5154887280053844`*^9, 3.515488728425385*^9}, {
   3.5154899820915775`*^9, 3.51548998443758*^9}, {3.515490022837637*^9, 
   3.5154900489096746`*^9}, {3.5155554802008343`*^9, 
   3.5155554804192348`*^9}, {3.515555607060257*^9, 3.5155556081834593`*^9}, {
   3.5155557178204517`*^9, 3.515555717992052*^9}, {3.515556258183897*^9, 
   3.5155562586206975`*^9}, {3.515557119087423*^9, 3.515557121053026*^9}, {
   3.515557206556776*^9, 3.5155572067439766`*^9}, {3.515557324851784*^9, 
   3.515557325194985*^9}, 3.515561850361741*^9, 3.515561887084205*^9, 
   3.5155769551487474`*^9, {3.515577153300296*^9, 3.5155771537058964`*^9}, 
   3.5155772371816435`*^9, {3.5155774971092997`*^9, 3.5155774973433*^9}, {
   3.5155795449144335`*^9, 3.515579560692176*^9}, 3.515579615858023*^9, {
   3.51557995936148*^9, 3.515579961592284*^9}, {3.5155805386731057`*^9, 
   3.515580540123908*^9}, {3.5156365321587973`*^9, 3.515636532824836*^9}, {
   3.515642919975212*^9, 3.5156429201624126`*^9}, {3.5156674977538834`*^9, 
   3.5156675003434877`*^9}, 3.5157601889607167`*^9, {3.5167753474590797`*^9, 
   3.516775351905088*^9}, {3.516775933521026*^9, 3.516775933708226*^9}, 
   3.520594491188651*^9, 3.520651469116159*^9, {3.520657347047433*^9, 
   3.5206573483266354`*^9}, 3.5206616976808662`*^9, {3.520826122456659*^9, 
   3.5208261228778596`*^9}, {3.5210121776752462`*^9, 
   3.5210121795784492`*^9}, {3.521025966546878*^9, 3.5210259673892794`*^9}, {
   3.52102627525582*^9, 3.5210262764570217`*^9}, {3.521089121499297*^9, 
   3.521089128207309*^9}, {3.5211029013047395`*^9, 3.521102903067542*^9}, {
   3.5211082448723335`*^9, 3.5211082474394803`*^9}, {3.521110455759789*^9, 
   3.5211104601500397`*^9}, {3.5211188384095125`*^9, 3.521118839751115*^9}, {
   3.5212028458408184`*^9, 3.5212028485152225`*^9}, {3.5212137765593843`*^9, 
   3.5212137784625883`*^9}, {3.5212534276941204`*^9, 
   3.5212534296129236`*^9}, {3.521253482029016*^9, 3.5212534835110188`*^9}, {
   3.5212589145719457`*^9, 3.521258916677949*^9}, {3.5224725208365192`*^9, 
   3.522472522271722*^9}, {3.5224735126253605`*^9, 3.5224735152617655`*^9}, {
   3.5224772404212036`*^9, 3.5224772407644043`*^9}, {3.522479720346547*^9, 
   3.5224797217817497`*^9}, {3.532340372180683*^9, 3.532340374556819*^9}, {
   3.532401831157181*^9, 3.532401832607983*^9}, {3.532415482623942*^9, 
   3.532415483388343*^9}, {3.5324155904669313`*^9, 3.532415591543333*^9}, 
   3.5324160859706016`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SelectedAmp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ShifeMomentum", "[", 
      RowBox[{"#", ",", "q1"}], "]"}], "&"}], "/@", "SelectedAmp"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5146281826126723`*^9, 3.5146282038911095`*^9}, {
   3.5148613327963743`*^9, 3.5148613350739784`*^9}, {3.51486964976467*^9, 
   3.51486964996747*^9}, {3.5149592492779627`*^9, 3.5149592527099686`*^9}, {
   3.515036651960314*^9, 3.5150367153432255`*^9}, {3.5150367825637436`*^9, 
   3.515036795340166*^9}, {3.5150528397373285`*^9, 3.5150528504077473`*^9}, {
   3.5150552737097955`*^9, 3.5150552739437957`*^9}, {3.515150038530755*^9, 
   3.5151500488267727`*^9}, {3.515150171271388*^9, 3.515150177651799*^9}, 
   3.5152147524837675`*^9, {3.515729238362321*^9, 3.5157292443527317`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tm", "=", 
   RowBox[{"SelectedAmp", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FeynAmpDenominator", "\[Rule]", "Times"}], ",", 
      RowBox[{"li1", "\[RuleDelayed]", "\[Gamma]"}], ",", 
      RowBox[{
       RowBox[{"PropagatorDenominator", "[", 
        RowBox[{"$p_", ",", "$m_"}], "]"}], "\[RuleDelayed]", 
       FractionBox["1", 
        RowBox[{
         RowBox[{"ScalarProductExpand", "@", 
          RowBox[{"FCI", "@", 
           RowBox[{"SP", "[", "$p", "]"}]}]}], "-", 
         SuperscriptBox["$m", "2"]}]]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5145519264147854`*^9, 3.514551927194786*^9}, {
   3.5145912560115433`*^9, 3.5145912567135444`*^9}, {3.514611248122836*^9, 
   3.51461126177286*^9}, {3.514611495420166*^9, 3.514611497978571*^9}, {
   3.514611575229906*^9, 3.5146115774919105`*^9}, {3.5146117337885847`*^9, 
   3.5146117409957976`*^9}, {3.514611810244319*^9, 3.5146118105407195`*^9}, 
   3.5146119394952564`*^9, {3.514612043641039*^9, 3.514612099223937*^9}, {
   3.514612613104853*^9, 3.5146126138380547`*^9}, {3.514613285966577*^9, 
   3.514613328601452*^9}, {3.5146283274191666`*^9, 3.514628328651569*^9}, {
   3.514859850374242*^9, 3.514859851840645*^9}, {3.5150528561017575`*^9, 
   3.515052889922617*^9}, {3.515487335671363*^9, 3.5154873362513638`*^9}, 
   3.515487815498004*^9, {3.5155801214971733`*^9, 3.515580123150776*^9}, 
   3.515636511329606*^9, {3.515642111747588*^9, 3.5156421222464066`*^9}, {
   3.5156423894592757`*^9, 3.5156423907072783`*^9}, {3.5156426137408695`*^9, 
   3.515642614364871*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tm", "=", 
   RowBox[{"ReplaceLines", "/@", "Tm"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.5146115885991297`*^9, 3.5146116022179537`*^9}, {
   3.5146116625276594`*^9, 3.514611664540063*^9}, 3.5146131996360254`*^9, {
   3.514859991975691*^9, 3.5148599951580963`*^9}, {3.5148627072666984`*^9, 
   3.5148627276715345`*^9}, {3.514864992391589*^9, 3.5148649972431974`*^9}, {
   3.514865345616537*^9, 3.5148653460689383`*^9}, {3.514867348403906*^9, 
   3.5148673497767076`*^9}, 3.514961991639927*^9, {3.514962541360832*^9, 
   3.514962544262437*^9}, {3.5149627198158536`*^9, 3.514962735930682*^9}, {
   3.5149634958182235`*^9, 3.51496349960903*^9}, {3.514965304233684*^9, 
   3.5149653077280903`*^9}, {3.5149679837853065`*^9, 3.514967984300107*^9}, {
   3.5150528675209775`*^9, 3.515052895725827*^9}, {3.515580150934425*^9, 
   3.5155801537892294`*^9}, {3.520832623118186*^9, 3.5208326335546045`*^9}, {
   3.52100228282404*^9, 3.5210022871140475`*^9}, {3.5213672715844994`*^9, 
   3.521367274174104*^9}, {3.5213690558722105`*^9, 3.521369056043811*^9}, {
   3.5213693211662765`*^9, 3.5213693214938774`*^9}, {3.52137935629986*^9, 
   3.521379358140663*^9}, {3.521443387456129*^9, 3.521443394179741*^9}, {
   3.532415805076508*^9, 3.5324158085709143`*^9}}],

Cell[BoxData[
 FormBox["\<\"Fri 9 Dec 2011 18:41:28\"\>", TraditionalForm]], "Output",
 CellChangeTimes->{3.532416004834859*^9, 3.5324160397321205`*^9, 
  3.532416088404206*^9}],

Cell[BoxData[
 FormBox["\<\"Fri 9 Dec 2011 18:44:51\"\>", TraditionalForm]], "Output",
 CellChangeTimes->{3.532416004834859*^9, 3.5324160397321205`*^9, 
  3.5324162914073625`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Using Apart Package", "Section",
 CellChangeTimes->{{3.5091803073097343`*^9, 3.5091803154373484`*^9}, {
   3.509180964351688*^9, 3.5091809650536895`*^9}, {3.5091818521777444`*^9, 
   3.509181852427345*^9}, 3.5099397719285793`*^9, {3.5099398090878444`*^9, 
   3.5099398472006645`*^9}, {3.5150529685935555`*^9, 3.51505298851479*^9}, {
   3.515053391962699*^9, 3.5150534033195186`*^9}, {3.5150535033936944`*^9, 
   3.515053511536909*^9}}],

Cell[CellGroupData[{

Cell["Load Package", "Subsection",
 CellChangeTimes->{{3.5099398639550943`*^9, 3.5099398674963007`*^9}, {
  3.5099545801394596`*^9, 3.509954590872278*^9}, {3.5150535194461226`*^9, 
  3.5150535209281254`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "UVPart`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResetDirectory", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5324015194180737`*^9, 3.532401525637429*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["UV Parts", "Subsection",
 CellChangeTimes->{{3.5099398639550943`*^9, 3.5099398674963007`*^9}, {
  3.5099545801394596`*^9, 3.509954590872278*^9}, {3.5150535194461226`*^9, 
  3.5150535209281254`*^9}, {3.532340542550428*^9, 3.5323405443905334`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"DateString", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Result", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"$UVPart", "[", 
      RowBox[{"#", ",", "q1"}], "]"}], "&"}], "/@", "Tm"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"DateString", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.532343738575974*^9, 3.532343751385707*^9}, {
  3.5324018445888042`*^9, 3.5324018727312536`*^9}, {3.5324026888622875`*^9, 
  3.5324026908902907`*^9}, {3.5324027637268186`*^9, 3.532402769654829*^9}}],

Cell[BoxData[
 FormBox["\<\"Fri 9 Dec 2011 18:44:55\"\>", TraditionalForm]], "Output",
 CellChangeTimes->{{3.5323437467364407`*^9, 3.532343752266757*^9}, 
   3.5323451351189313`*^9, 3.5324113460894766`*^9, 3.5324155331524305`*^9, {
   3.53241558993653*^9, 3.5324156109653673`*^9}, 3.5324157960752926`*^9, 
   3.532415950733964*^9, 3.5324160173304806`*^9, 3.532416051915742*^9, 
   3.53241629588457*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      SubscriptBox["C", "F"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"D", "-", "2"}], ")"}], "2"], " ", "e", " ", 
      SubsuperscriptBox["g", "s", "4"], " ", 
      SuperscriptBox["\[Epsilon]", 
       RowBox[{
        FormBox[
         FormBox["\[Gamma]",
          TraditionalForm],
         TraditionalForm], 
        FormBox[
         FormBox["\[Psi]",
          TraditionalForm],
         TraditionalForm], 
        FormBox["p3",
         TraditionalForm], 
        FormBox["p4",
         TraditionalForm]}]]}], 
     RowBox[{"3", " ", 
      SqrtBox[
       SubscriptBox["C", "A"]], " ", "D", " ", 
      SuperscriptBox["mc", "3"], " ", 
      SuperscriptBox["s", "2"], " ", "\[Omega]"}]]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.5323437467364407`*^9, 3.532343752266757*^9}, 
   3.5323451351189313`*^9, 3.5324113460894766`*^9, 3.5324155331524305`*^9, {
   3.53241558993653*^9, 3.5324156109653673`*^9}, 3.5324157960752926`*^9, 
   3.532415950733964*^9, 3.5324160173304806`*^9, 3.532416051915742*^9, 
   3.532416296180971*^9}],

Cell[BoxData[
 FormBox["\<\"Fri 9 Dec 2011 18:44:56\"\>", TraditionalForm]], "Output",
 CellChangeTimes->{{3.5323437467364407`*^9, 3.532343752266757*^9}, 
   3.5323451351189313`*^9, 3.5324113460894766`*^9, 3.5324155331524305`*^9, {
   3.53241558993653*^9, 3.5324156109653673`*^9}, 3.5324157960752926`*^9, 
   3.532415950733964*^9, 3.5324160173304806`*^9, 3.532416051915742*^9, 
   3.532416296196571*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Result", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "/.", 
  RowBox[{"D", "\[Rule]", "4"}]}]], "Input",
 CellChangeTimes->{{3.532415050471983*^9, 3.5324150516107845`*^9}, {
  3.5324160980294228`*^9, 3.5324161060790367`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", 
     SubscriptBox["C", "F"], " ", "e", " ", 
     SubsuperscriptBox["g", "s", "4"], " ", 
     SuperscriptBox["\[Epsilon]", 
      RowBox[{
       FormBox[
        FormBox["\[Gamma]",
         TraditionalForm],
        TraditionalForm], 
       FormBox[
        FormBox["\[Psi]",
         TraditionalForm],
        TraditionalForm], 
       FormBox["p3",
        TraditionalForm], 
       FormBox["p4",
        TraditionalForm]}]]}], 
    RowBox[{"3", " ", 
     SqrtBox[
      SubscriptBox["C", "A"]], " ", 
     SuperscriptBox["mc", "3"], " ", 
     SuperscriptBox["s", "2"], " ", "\[Omega]"}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.532416296196571*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1264, 665},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"6.0 for Microsoft Windows (32-bit) (April 28, 2007)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[568, 21, 319, 7, 52, "Input"],
Cell[890, 30, 298, 5, 31, "Input"],
Cell[CellGroupData[{
Cell[1213, 39, 356, 5, 71, "Section"],
Cell[1572, 46, 1542, 35, 33, "Input"],
Cell[3117, 83, 253, 6, 31, "Input"],
Cell[3373, 91, 564, 15, 31, "Input"],
Cell[3940, 108, 838, 22, 33, "Input"],
Cell[4781, 132, 254, 5, 31, "Input"],
Cell[5038, 139, 241, 5, 31, "Input"],
Cell[5282, 146, 188, 4, 31, "Input"],
Cell[5473, 152, 288, 7, 31, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[5798, 164, 467, 6, 41, "Section"],
Cell[CellGroupData[{
Cell[6290, 174, 233, 3, 36, "Subsubsection"],
Cell[6526, 179, 2671, 55, 172, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[9234, 239, 187, 2, 30, "Subsubsection"],
Cell[9424, 243, 1395, 32, 72, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[10856, 280, 298, 3, 30, "Subsubsection"],
Cell[11157, 285, 2692, 61, 128, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13898, 352, 219, 3, 71, "Section"],
Cell[CellGroupData[{
Cell[14142, 359, 106, 1, 28, "Subsubsection"],
Cell[14251, 362, 478, 10, 72, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14766, 377, 278, 3, 28, "Subsubsection"],
Cell[15047, 382, 1730, 29, 72, "Input"],
Cell[16780, 413, 2563, 64, 212, "Input"],
Cell[19346, 479, 1005, 28, 92, "Input"],
Cell[20354, 509, 5271, 107, 292, "Input"],
Cell[25628, 618, 1201, 36, 31, "Input"],
Cell[26832, 656, 1292, 30, 152, "Input"],
Cell[28127, 688, 26888, 459, 623, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[55052, 1152, 258, 3, 22, "Subsubsection"],
Cell[55313, 1157, 3487, 51, 31, "Input"],
Cell[58803, 1210, 810, 15, 31, "Input"],
Cell[59616, 1227, 1599, 30, 48, "Input"],
Cell[CellGroupData[{
Cell[61240, 1261, 1404, 21, 72, "Input"],
Cell[62647, 1284, 177, 3, 30, "Output"],
Cell[62827, 1289, 179, 3, 30, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[63067, 1299, 441, 6, 71, "Section"],
Cell[CellGroupData[{
Cell[63533, 1309, 208, 3, 36, "Subsection"],
Cell[63744, 1314, 329, 8, 72, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64110, 1327, 252, 3, 36, "Subsection"],
Cell[CellGroupData[{
Cell[64387, 1334, 540, 12, 72, "Input"],
Cell[64930, 1348, 402, 6, 30, "Output"],
Cell[65335, 1356, 1191, 35, 56, "Output"],
Cell[66529, 1393, 403, 6, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66969, 1404, 257, 6, 31, "Input"],
Cell[67229, 1412, 764, 27, 56, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
